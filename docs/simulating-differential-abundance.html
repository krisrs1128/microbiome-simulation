<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Simulating Differential Abundance | Simulation for Microbiome Analysis</title>
<meta name="author" content="Kris Sankaran, Saritha Kodikara, Jingyi Jessica Li, and Kim-Anh Lê Cao">
<meta name="description" content="Before we consider simulating entire microbial communities, with their complex correlation structures, let’s learn simulators for individual taxa. This is already enough to analyze taxon-level...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="Chapter 2 Simulating Differential Abundance | Simulation for Microbiome Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://krisrs1128.github.io/microbiome-simulation/simulating-differential-abundance.html">
<meta property="og:description" content="Before we consider simulating entire microbial communities, with their complex correlation structures, let’s learn simulators for individual taxa. This is already enough to analyze taxon-level...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Simulating Differential Abundance | Simulation for Microbiome Analysis">
<meta name="twitter:description" content="Before we consider simulating entire microbial communities, with their complex correlation structures, let’s learn simulators for individual taxa. This is already enough to analyze taxon-level...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Simulation for Microbiome Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="active" href="simulating-differential-abundance.html"><span class="header-section-number">2</span> Simulating Differential Abundance</a></li>
<li><a class="" href="multivariate-power-analysis.html"><span class="header-section-number">3</span> Multivariate Power Analysis</a></li>
<li><a class="" href="microbiome-networks.html"><span class="header-section-number">4</span> Microbiome Networks</a></li>
<li><a class="" href="batch-effect-correction.html"><span class="header-section-number">5</span> Batch Effect Correction</a></li>
<li><a class="" href="vertical-integration.html"><span class="header-section-number">6</span> Vertical Integration</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="simulating-differential-abundance" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Simulating Differential Abundance<a class="anchor" aria-label="anchor" href="#simulating-differential-abundance"><i class="fas fa-link"></i></a>
</h1>
<p>Before we consider simulating entire microbial communities, with their complex
correlation structures, let’s learn simulators for individual taxa. This is
already enough to analyze taxon-level differential abundance approaches. For
example, at the end of this session, we’ll apply a simulator to study the power
and false discovery rate of limma-voom when applied to microbiome data (as
opposed to the bulk RNA-seq data for which it was originally proposed). Also,
marginal modeling is a first step towards multivariate (community-wide)
modeling, which we’ll explore in the next session.</p>
<p>Let’s load the necessary packages. Instructions for <code>scDesigner</code> and <code>MIGsim</code>
can be found in the pre-workshop announcement. <code>SummarizedExperiment</code> is on
Bioconductor, and all other packages are on CRAN.</p>
<p>Let’s train a simulator to fit the Atlas dataset. We’ll use two
covariates. <code>bmi_group</code> is the main covariate of interest – we want to see how
microbiome composition varies among people with different BMI. The <code>log_depth</code>
term is used to adjust for differential sequencing depths. We found it helpful
to fixed zero inflation across the population (<code>nu</code>), so we have set <code>nu = ~1</code>.
Finally, since we want to eventually evaluate testing methods that are designed
for count data, we have used the (Z)ero (I)nflated (N)egative (B)inomial
location-shape-scale model.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">atlas</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fmla</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  mu <span class="op">=</span> <span class="op">~</span> <span class="va">bmi_group</span> <span class="op">+</span> <span class="va">log_depth</span>,</span>
<span>  sigma <span class="op">=</span> <span class="op">~</span> <span class="va">bmi_group</span> <span class="op">+</span> <span class="va">log_depth</span>,</span>
<span>  nu <span class="op">=</span> <span class="op">~</span><span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scDesigner/man/setup_simulator.html">setup_simulator</a></span><span class="op">(</span><span class="va">atlas</span>, <span class="va">fmla</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/gamboostLSS/man/families.html">ZINBLSS</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">estimate</span><span class="op">(</span>nu <span class="op">=</span> <span class="fl">0.01</span>, mstop <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<div id="critique" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Critique<a class="anchor" aria-label="anchor" href="#critique"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Exercise</strong>: The block below combines the real and simulated experiments and
visualizes their difference. With your neighbors, discuss how well the simulator
approximates the original template.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>  real <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/scDesigner/man/pivot_experiment.html">pivot_experiment</a></span><span class="op">(</span><span class="va">atlas</span><span class="op">)</span>, <span class="co"># real data</span></span>
<span>  simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/scDesigner/man/pivot_experiment.html">pivot_experiment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span><span class="op">)</span>, <span class="co"># simulated</span></span>
<span>  .id <span class="op">=</span> <span class="st">"source"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">feature</span>, <span class="va">value</span>, <span class="va">median</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">bmi_group</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">source</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="simulation_for_microbiome_files/figure-html/contrast-simulators-1.png" width="672"></div>
<p><strong>Solution</strong>: The clearest difference is that, for these more abundant taxa, there there are
not many low or zero counts. In contrast, the simulated data tend to have a long
left tail (the many outlier circles on the left side of the boxplots),
reflecting the fact that samples from the negative binomial distribution usually
have support for all counts <span class="math inline">\(\geq 0\)</span>. Nonetheless, the ordering of abundances
between the groups typically agrees between the real and simulated data. The
interquartile ranges for each taxon also seem to roughly match.</p>
</div>
<div id="power-analysis-loop" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Power Analysis Loop<a class="anchor" aria-label="anchor" href="#power-analysis-loop"><i class="fas fa-link"></i></a>
</h2>
<p>To run a power analysis, we need to define datasets that have known ground
truth. Then, we can run any differential abundance methods we want and see how
many of the true associations are recovered (and how many nulls are falsely
rejected). To this end, we’ll remove associations from 16 of the original 24
genera, just like we removed group interactions in our spline fits above. We’ll
choose to remove the 16 that have the weakest associations in the original data.
This is helpful because, even if we use <code>bmi_group</code> in our formula, if in
reality there is no (or very weak) effect, then even if our simulator considers
it as a true signal, the difference may be hard to detect. Eventually, our
package will include functions for modifying these effects directly; at this
point, though, we can only indirectly modify parameters by re-estimating them
with new formulas.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nulls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MIGsim/man/differential_analysis.html">differential_analysis</a></span><span class="op">(</span><span class="va">atlas</span>, <span class="st">"LIMMA_voom"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">null_fmla</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="op">~</span><span class="va">log_depth</span>, sigma <span class="op">=</span> <span class="op">~</span><span class="va">log_depth</span>, nu <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="va">sim</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="va">nulls</span><span class="op">)</span>, link <span class="op">=</span> <span class="va">null_fmla</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">estimate</span><span class="op">(</span>nu <span class="op">=</span> <span class="fl">0.01</span>, mstop <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have ground truth associations, we’ll evaluate LIMMA-voom for
differential analysis. We consider sample sizes ranging from 50 to 1200, and we
simulate 10 datasets for each sample size.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  sample_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">1200</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  n_rep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">config</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">atlas_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">config</span><span class="op">$</span><span class="va">sample_size</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MIGsim/man/differential_analysis.html">differential_analysis</a></span><span class="op">(</span><span class="va">atlas_</span>, <span class="st">"LIMMA_voom"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/MIGsim/man/da_metrics.html">da_metrics</a></span><span class="op">(</span><span class="va">nulls</span>, level <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{i}/{nrow(config)}"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>## 1/50
## 2/50
## 3/50
## 4/50
## 5/50
## 6/50
## 7/50
## 8/50
## 9/50
## 10/50
## 11/50
## 12/50
## 13/50
## 14/50
## 15/50
## 16/50
## 17/50
## 18/50
## 19/50
## 20/50
## 21/50
## 22/50
## 23/50
## 24/50
## 25/50
## 26/50
## 27/50
## 28/50
## 29/50
## 30/50
## 31/50
## 32/50
## 33/50
## 34/50
## 35/50
## 36/50
## 37/50
## 38/50
## 39/50
## 40/50
## 41/50
## 42/50
## 43/50
## 44/50
## 45/50
## 46/50
## 47/50
## 48/50
## 49/50
## 50/50</code></pre>
<p><strong>Exercise</strong>: Visualize the results. How would you interpret the results of the
power analysis? Based on your earlier critique of the simulator, do you think
the estimated power here is conservative, liberal, or about right?</p>
<p><strong>Solution</strong>: We’ll use the <code>stat_pointinterval</code> function from the <code>ggdist</code> package to
visualize the range of empirical power estimates across sample sizes. We can see
that the average false discovery proportion is always controlled below 0.3,
though the variance in this proportion can be quite high. We can also see that
we would have quite good power with <span class="math inline">\(n \geq 625\)</span> samples, but the worst case
scenarios can be quite poor for anything with fewer samples.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">results</span>, .id <span class="op">=</span> <span class="st">"run"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">config</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_pointinterval.html">stat_pointinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">metric</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="simulation_for_microbiome_files/figure-html/visualize-da-power-1.png" width="672"></div>
<p>We expect that this result is somewhat conservative. This is because the
original data have more symmetric distributions than our simulation, so limma’s
transformation to normality is likely easier to accomplish than in our more
highly skewed data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## R version 4.4.0 (2024-04-24)
## Platform: aarch64-apple-darwin20
## Running under: macOS Ventura 13.4
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: America/Los_Angeles
## tzcode source: internal
## 
## attached base packages:
##  [1] splines   parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] TreeSummarizedExperiment_2.12.0 Biostrings_2.72.1               XVector_0.44.0                  SingleCellExperiment_1.26.0     scDesigner_0.0.0.9000           purrr_1.0.2                    
##  [7] MIGsim_0.0.0.9000               tidyr_1.3.1                     tibble_3.2.1                    scico_1.5.0                     pwr_1.3-0                       patchwork_1.2.0                
## [13] mutoss_0.1-13                   mvtnorm_1.2-5                   mixOmics_6.28.0                 lattice_0.22-6                  MASS_7.3-60.2                   glue_1.7.0                     
## [19] ggplot2_3.5.1                   ggdist_3.3.2                    gamboostLSS_2.0-7               mboost_2.9-10                   stabs_0.6-4                     forcats_1.0.0                  
## [25] dplyr_1.1.4                     SummarizedExperiment_1.34.0     Biobase_2.64.0                  GenomicRanges_1.56.0            GenomeInfoDb_1.40.0             IRanges_2.38.0                 
## [31] S4Vectors_0.42.0                BiocGenerics_0.50.0             MatrixGenerics_1.16.0           matrixStats_1.3.0               SpiecEasi_1.1.3                 CovTools_0.5.4                 
## 
## loaded via a namespace (and not attached):
##   [1] minpack.lm_1.2-4        rpart_4.1.23            lifecycle_1.0.4         Rdpack_2.6              edgeR_4.2.0             doParallel_1.0.17       insight_0.20.1          magrittr_2.0.3         
##   [9] limma_3.60.2            sass_0.4.9              rmarkdown_2.27          jquerylib_0.1.4         yaml_2.3.9              plotrix_3.8-4           RColorBrewer_1.1-3      ADGofTest_0.3          
##  [17] multcomp_1.4-25         abind_1.4-5             zlibbioc_1.50.0         expm_0.999-9            quadprog_1.5-8          pspline_1.0-20          kde1d_1.0.7             yulab.utils_0.1.4      
##  [25] rgl_1.3.1               pracma_2.4.4            TH.data_1.1-2           sandwich_3.1-0          GenomeInfoDbData_1.2.12 ggrepel_0.9.5           tidytree_0.4.6          ellipse_0.5.0          
##  [33] RSpectra_0.16-1         codetools_0.2-20        DelayedArray_0.30.1     shapes_1.2.7            tidyselect_1.2.1        shape_1.4.6.1           farver_2.1.2            UCSC.utils_1.0.0       
##  [41] randtoolbox_2.0.4       base64enc_0.1-3         jsonlite_1.8.8          multtest_2.60.0         Formula_1.2-5           survival_3.7-0          iterators_1.0.14        foreach_1.5.2          
##  [49] tools_4.4.0             progress_1.2.3          treeio_1.28.0           Rcpp_1.0.12             rARPACK_0.11-0          gridExtra_2.3           SparseArray_1.4.8       xfun_0.45              
##  [57] distributional_0.4.0    withr_3.0.0             numDeriv_2016.8-1.1     fastmap_1.2.0           fansi_1.0.6             digest_0.6.36           R6_2.5.1                colorspace_2.1-0       
##  [65] inum_1.0-5              copula_1.1-3            flare_1.7.0.1           utf8_1.2.4              generics_0.1.3          corpcor_1.6.10          prettyunits_1.2.0       pulsar_0.3.11          
##  [73] httr_1.4.7              htmlwidgets_1.6.4       S4Arrays_1.4.1          scatterplot3d_0.3-44    rngWELL_0.10-9          pkgconfig_2.0.3         geigen_2.3              gtable_0.3.5           
##  [81] pcaPP_2.0-4             htmltools_0.5.8.1       bookdown_0.39.1         scales_1.3.0            SHT_0.1.8               knitr_1.47              rstudioapi_0.16.0       reshape2_1.4.4         
##  [89] nlme_3.1-164            cachem_1.1.0            zoo_1.8-12              stringr_1.5.1           libcoin_1.0-10          pillar_1.9.0            grid_4.4.0              vctrs_0.6.5            
##  [97] VGAM_1.1-11             huge_1.3.5              gamlss.dist_6.1-1       evaluate_0.24.0         cli_3.6.3               locfit_1.5-9.9          compiler_4.4.0          rlang_1.1.4            
## [105] crayon_1.5.3            labeling_0.4.3          fs_1.6.4                plyr_1.8.9              stringi_1.8.4           BiocParallel_1.38.0     nnls_1.5                assertthat_0.2.1       
## [113] rvinecopulib_0.6.3.1.1  munsell_0.5.1           gsl_2.1-8               lazyeval_0.2.2          glmnet_4.1-8            Matrix_1.7-0            hms_1.1.3               stabledist_0.7-1       
## [121] statmod_1.5.0           highr_0.11              rbibutils_2.2.16        memoise_2.0.1           partykit_1.2-20         igraph_2.0.3            bslib_0.7.0.9000        ape_5.8</code></pre>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> Introduction</a></div>
<div class="next"><a href="multivariate-power-analysis.html"><span class="header-section-number">3</span> Multivariate Power Analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#simulating-differential-abundance"><span class="header-section-number">2</span> Simulating Differential Abundance</a></li>
<li><a class="nav-link" href="#critique"><span class="header-section-number">2.1</span> Critique</a></li>
<li><a class="nav-link" href="#power-analysis-loop"><span class="header-section-number">2.2</span> Power Analysis Loop</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Simulation for Microbiome Analysis</strong>" was written by Kris Sankaran, Saritha Kodikara, Jingyi Jessica Li, and Kim-Anh Lê Cao. It was last built on 2024-09-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
