<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Integrative Simulation | Simulation for Microbiome Analysis</title>
  <meta name="description" content="Examples illustrating the use of simulation for microbiome analysis, companion to the review article:" />
  <meta name="generator" content="bookdown 0.39.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Integrative Simulation | Simulation for Microbiome Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Examples illustrating the use of simulation for microbiome analysis, companion to the review article:" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Integrative Simulation | Simulation for Microbiome Analysis" />
  
  <meta name="twitter:description" content="Examples illustrating the use of simulation for microbiome analysis, companion to the review article:" />
  

<meta name="author" content="Kris Sankaran, Saritha Kodikara, and Kim-Anh Lê Cao" />


<meta name="date" content="2024-06-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="microbiome-networks.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulation for Microbiome Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#setup"><i class="fa fa-check"></i><b>1.1</b> Setup</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#using-summarizedexperiment"><i class="fa fa-check"></i><b>1.2</b> Using <code>SummarizedExperiment</code></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#warm-up-a-gaussian-example"><i class="fa fa-check"></i><b>1.3</b> Warm-up: A Gaussian Example</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulating-differential-abundance.html"><a href="simulating-differential-abundance.html"><i class="fa fa-check"></i><b>2</b> Simulating Differential Abundance</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulating-differential-abundance.html"><a href="simulating-differential-abundance.html#critique"><i class="fa fa-check"></i><b>2.1</b> Critique</a></li>
<li class="chapter" data-level="2.2" data-path="simulating-differential-abundance.html"><a href="simulating-differential-abundance.html#power-analysis-loop"><i class="fa fa-check"></i><b>2.2</b> Power Analysis Loop</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multivariate-power-analysis.html"><a href="multivariate-power-analysis.html"><i class="fa fa-check"></i><b>3</b> Multivariate Power Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multivariate-power-analysis.html"><a href="multivariate-power-analysis.html#interpreting-pls-da"><i class="fa fa-check"></i><b>3.1</b> Interpreting PLS-DA</a></li>
<li class="chapter" data-level="3.2" data-path="multivariate-power-analysis.html"><a href="multivariate-power-analysis.html#estimation"><i class="fa fa-check"></i><b>3.2</b> Estimation</a></li>
<li class="chapter" data-level="3.3" data-path="multivariate-power-analysis.html"><a href="multivariate-power-analysis.html#evaluation"><i class="fa fa-check"></i><b>3.3</b> Evaluation</a></li>
<li class="chapter" data-level="3.4" data-path="multivariate-power-analysis.html"><a href="multivariate-power-analysis.html#pls-da-power-analysis"><i class="fa fa-check"></i><b>3.4</b> PLS-DA Power Analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="microbiome-networks.html"><a href="microbiome-networks.html"><i class="fa fa-check"></i><b>4</b> Microbiome Networks</a>
<ul>
<li class="chapter" data-level="4.1" data-path="microbiome-networks.html"><a href="microbiome-networks.html#estimation-1"><i class="fa fa-check"></i><b>4.1</b> Estimation</a></li>
<li class="chapter" data-level="4.2" data-path="microbiome-networks.html"><a href="microbiome-networks.html#evaluation-1"><i class="fa fa-check"></i><b>4.2</b> Evaluation</a></li>
<li class="chapter" data-level="4.3" data-path="microbiome-networks.html"><a href="microbiome-networks.html#block-covariance"><i class="fa fa-check"></i><b>4.3</b> Block Covariance</a></li>
<li class="chapter" data-level="4.4" data-path="microbiome-networks.html"><a href="microbiome-networks.html#generalization"><i class="fa fa-check"></i><b>4.4</b> Generalization</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="integrative-simulation.html"><a href="integrative-simulation.html"><i class="fa fa-check"></i><b>5</b> Integrative Simulation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="integrative-simulation.html"><a href="integrative-simulation.html#horizontal-integration"><i class="fa fa-check"></i><b>5.1</b> Horizontal Integration</a></li>
<li class="chapter" data-level="5.2" data-path="integrative-simulation.html"><a href="integrative-simulation.html#interlude-using-map"><i class="fa fa-check"></i><b>5.2</b> Interlude: Using map</a></li>
<li class="chapter" data-level="5.3" data-path="integrative-simulation.html"><a href="integrative-simulation.html#vertical-integration"><i class="fa fa-check"></i><b>5.3</b> Vertical Integration</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulation for Microbiome Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="integrative-simulation" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Integrative Simulation<a href="integrative-simulation.html#integrative-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Integration can be a subtle exercise. We need to balance our interest in seeing
similarities between datasets with the risk of making things seem more similar
than they really are. Simulation can help navigate this subtlety by letting us
see how integration methods would behave in situations where we know exactly how
the different datasets are related. This note will illustrate this perspective
by showing how simulation can help with both horizontal (across batches) and
vertical (across assays) integration. We’ll have a brief interlude on the <code>map</code>
function in the <code>purrr</code>, which is helpful for concisely writing code that would
otherwise need for loops (e.g., over batches or assays).</p>
<p>As usual, let’s load the libraries we’ll need. Remember that instructions for
installing <code>MIGsim</code> and <code>scDesigner</code> are documented in the repository
<a href="https://github.com/krisrs1128/intro-to-simulation/">README</a>.</p>
<div id="horizontal-integration" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Horizontal Integration<a href="integrative-simulation.html#horizontal-integration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first example is about simultaneously analyzing several batches in a dataset
about the efficiency of anaerobic digestion (AD) of organic matter. The
essential problem is that, in this study, the samples could not be collected
simultaneously. Small differences across separate runs could lead to systematic
differences in the resulting data, which can obfuscate the more interesting
between-group variation that the experiment was intended to uncover. For
example, in the AD dataset, the date of the sequencing run has a global effect
on measured community composition, which we can see right away from a principal
components plot:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="integrative-simulation.html#cb68-1" tabindex="-1"></a><span class="fu">data</span>(anaerobic)</span>
<span id="cb68-2"><a href="integrative-simulation.html#cb68-2" tabindex="-1"></a><span class="fu">pca_batch</span>(anaerobic, <span class="at">facet =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb68-3"><a href="integrative-simulation.html#cb68-3" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#191C59&quot;</span>, <span class="st">&quot;#bc0c3c&quot;</span>)) <span class="sc">+</span></span>
<span id="cb68-4"><a href="integrative-simulation.html#cb68-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">col =</span> <span class="st">&quot;Treatment&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;Batch&quot;</span>)</span></code></pre></div>
<p><img src="simulation_for_microbiome_files/figure-html/pca-anaerobic-1.png" width="672" /></p>
<p>You can learn more about the general microbiome batch effect integration problem
in <a href="https://doi.org/10.1093/bib/bbz105">(Wang and Le Cao, 2020)</a>, which is where
this dataset example and the batch effect correction code below comes from. The
article also reviews mechanisms that could lead to batch effects in microbiome
data, together with methods for removing these effects and the situations within
which they are most appropriate.</p>
<p>In batch effect correction, it’s important to remove as much of the batch
variation as possible without accidentally also removing the real biological
variation that would have been present even if all the samples had been
sequenced together. This is sometimes called ``overintegration,’’ and this is an
especially high risk if some of the real biological variation is quite subtle,
e.g., a rare cell type or one that is very similar to a more prominent one.
Simulation can help us gauge the extent to which different methods may or may
not overintegrate. Since we get to control the between-batch and and
between-biological-condition differences, we can see the extent to which
integration methods can remove the former while preserving the latter.</p>
<p>The block below estimates a candidate simulator. By using the formula <code>~ batch + treatment</code>, we’re allowing for taxon-wise differences due to batch and
treatment. Note that in principle, we could estimate an interaction between
batch and treatment (the treatment could appear stronger in some batches than
others). I encourage you to try estimating that model; however, visually
analyzing the output suggests that this full model has a tendancy to overfit.
Since the data have already been centered log-ratio transformed, we can try out
a Gaussian marginal model. The AD dataset has relatively few samples
compared to the number of features, so we’ll use a copula that’s designed for
this setting.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="integrative-simulation.html#cb69-1" tabindex="-1"></a>simulator <span class="ot">&lt;-</span> <span class="fu">setup_simulator</span>(</span>
<span id="cb69-2"><a href="integrative-simulation.html#cb69-2" tabindex="-1"></a>  anaerobic,</span>
<span id="cb69-3"><a href="integrative-simulation.html#cb69-3" tabindex="-1"></a>  <span class="sc">~</span> batch <span class="sc">+</span> treatment,</span>
<span id="cb69-4"><a href="integrative-simulation.html#cb69-4" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">GaussianLSS</span>(),</span>
<span id="cb69-5"><a href="integrative-simulation.html#cb69-5" tabindex="-1"></a>  <span class="at">copula =</span> <span class="fu">copula_adaptive</span>(<span class="at">thr =</span> .<span class="dv">1</span>)</span>
<span id="cb69-6"><a href="integrative-simulation.html#cb69-6" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb69-7"><a href="integrative-simulation.html#cb69-7" tabindex="-1"></a>  <span class="fu">estimate</span>(<span class="at">nu =</span> <span class="fl">0.05</span>, <span class="at">mstop =</span> <span class="dv">100</span>) <span class="co"># lower nu -&gt; stable training</span></span></code></pre></div>
<p>We can simulate from the fitted model and evaluate the quality of our fit using
<code>contrast_boxplot</code>. This is a light wrapper of the ggplot2 code we used to
compare experiments from our first session, and you can read its definition
<a href="https://github.com/krisrs1128/intro-to-simulation/blob/10fa498aea952684204b2f15c387a7983c30626d/MIGsim/R/plot.R#L26">here</a>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="integrative-simulation.html#cb70-1" tabindex="-1"></a>anaerobic_sim <span class="ot">&lt;-</span> <span class="fu">sample</span>(simulator)</span>
<span id="cb70-2"><a href="integrative-simulation.html#cb70-2" tabindex="-1"></a><span class="fu">contrast_boxplot</span>(anaerobic, anaerobic_sim)</span></code></pre></div>
<p><img src="simulation_for_microbiome_files/figure-html/eval-anaerobic-1.png" width="672" /></p>
<p><strong>Exercise</strong> Propose and create at least one other visualization that can be
used to compare and contrast the simulator with real data. What conclusions can
you draw?</p>
<p><strong>Solution</strong>: There are many possible answers:</p>
<ul>
<li>Boxplots across taxa with different overall abundance levels.</li>
<li>Analogous histograms or CDF plots, to show the entire distributions, rather than just summarized quantiles.</li>
<li>Pair scatterplots, to see how well the bivariate relationships between taxa are preserved.</li>
<li>Dimensionality reduction on the simulated data, to see how well it matches global structure in the original data.</li>
</ul>
<p>We’ll implement the last idea using PCA. This should be contrasted with the PCA
plot on the original data above. It’s okay if the plot seems rotated relative to
the oiginal plot – PCA is only unique up to rotation. The main characteristic
we’re looking for is that the relative sizes of the batch and treatment effects
seem reasonaly well-preserved, since these will be the types of effects that our
later batch effect integration methods must be able to distinguish.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="integrative-simulation.html#cb71-1" tabindex="-1"></a><span class="fu">pca_batch</span>(anaerobic_sim)</span></code></pre></div>
<p><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-26-1.png" width="672" />
:::</p>
<p>To study the risk for overintegration, let’s imagine that there were a third
treatment group with relatively fewer samples. This is the type of group that a
correction method might accidentally blend in with the rest, if it’s too
aggressive. We’ve defined the imaginary experiment using the data.frame below.
The <code>treatment</code> level <code>1.8</code> is the new one. We’ve supposed there are between 1 -
3 technical replicates (<code>extraction</code>) for each biological sample (<code>sample</code>), and
the batch dates are the same as before.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="integrative-simulation.html#cb72-1" tabindex="-1"></a><span class="fu">data</span>(imaginary_design)</span>
<span id="cb72-2"><a href="integrative-simulation.html#cb72-2" tabindex="-1"></a><span class="fu">summary</span>(imaginary_design)</span></code></pre></div>
<pre><code>##    extraction        batch      treatment           rep           sample   
##  Min.   :1    09/04/2015:36   Min.   :0.0000   Min.   :1.00   1      :  2  
##  1st Qu.:1    14/04/2016:36   1st Qu.:0.0000   1st Qu.:1.75   2      :  2  
##  Median :2    01/07/2016:36   Median :1.0000   Median :2.50   3      :  2  
##  Mean   :2    14/11/2016:36   Mean   :0.7167   Mean   :2.75   4      :  2  
##  3rd Qu.:3    21/09/2017:36   3rd Qu.:1.0000   3rd Qu.:4.00   5      :  2  
##  Max.   :3                    Max.   :1.8000   Max.   :5.00   6      :  2  
##                                                               (Other):168</code></pre>
<p>We can simulate from the new design and look at how different this new treatment
group seems from the others. It’s a subtle effect, definitely smaller than the
batch effect, but also separate enough that we should be able to preserve it.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="integrative-simulation.html#cb74-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb74-2"><a href="integrative-simulation.html#cb74-2" tabindex="-1"></a>anaerobic_sim <span class="ot">&lt;-</span> <span class="fu">sample</span>(simulator, <span class="at">new_data =</span> imaginary_design)</span>
<span id="cb74-3"><a href="integrative-simulation.html#cb74-3" tabindex="-1"></a>p[[<span class="st">&quot;sim&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">pca_batch</span>(anaerobic_sim)</span></code></pre></div>
<p>We’ve defined a <code>batch_correct</code> wrapper function that implements either the
RUV-III or ComBat batch effect correction methods. Their outputs are contrasted
in the PCAs below. It looks like ComBat might be somewhat too aggressive,
causing the <code>1</code> and <code>1.8</code> treatment groups to substantially overlap, while RUV
is a bit more conservative, keeping the treatment groups nicely separate. As an
aside, we note that this conclusion can depend on the number of replicates and
total number of samples available. We’ve included the code for generating the
<code>imaginary_design</code> data.frame in <a href="https://github.com/krisrs1128/intro-to-simulation/blob/10fa498aea952684204b2f15c387a7983c30626d/MIGsim/vignettes/process-integration.Rmd#L76">a vignette</a>
for the <code>MIGsim</code> package. Can you find settings that lead either method astray?</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="integrative-simulation.html#cb75-1" tabindex="-1"></a>p[[<span class="st">&quot;ruv&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">pca_batch</span>(<span class="fu">batch_correct</span>(anaerobic_sim, <span class="st">&quot;ruv&quot;</span>))</span>
<span id="cb75-2"><a href="integrative-simulation.html#cb75-2" tabindex="-1"></a>p[[<span class="st">&quot;combat&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">pca_batch</span>(<span class="fu">batch_correct</span>(anaerobic_sim, <span class="st">&quot;combat&quot;</span>))</span></code></pre></div>
<p><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="integrative-simulation.html#cb76-1" tabindex="-1"></a>prediction_errors <span class="ot">&lt;-</span> <span class="cf">function</span>(df, source_) {</span>
<span id="cb76-2"><a href="integrative-simulation.html#cb76-2" tabindex="-1"></a>  y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lda</span>(treatment <span class="sc">~</span> PC1 <span class="sc">+</span> PC2, <span class="at">data =</span> df), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)<span class="sc">$</span>class</span>
<span id="cb76-3"><a href="integrative-simulation.html#cb76-3" tabindex="-1"></a>  <span class="fu">table</span>(df<span class="sc">$</span>treatment, y_hat)</span>
<span id="cb76-4"><a href="integrative-simulation.html#cb76-4" tabindex="-1"></a>}</span>
<span id="cb76-5"><a href="integrative-simulation.html#cb76-5" tabindex="-1"></a></span>
<span id="cb76-6"><a href="integrative-simulation.html#cb76-6" tabindex="-1"></a><span class="fu">map</span>(p, <span class="sc">~</span> <span class="fu">prediction_errors</span>(.<span class="sc">$</span>data))</span></code></pre></div>
<pre><code>## $sim
##      y_hat
##        0  1 1.8
##   0   62 13   0
##   1   15 56   4
##   1.8  1 14  15
## 
## $ruv
##      y_hat
##        0  1 1.8
##   0   70  5   0
##   1    2 67   6
##   1.8  0  8  22
## 
## $combat
##      y_hat
##        0  1 1.8
##   0   65 10   0
##   1   12 59   4
##   1.8  1 12  17</code></pre>
</div>
<div id="interlude-using-map" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Interlude: Using map<a href="integrative-simulation.html#interlude-using-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the examples below, we’ll find it helpful to use the function <code>map</code> in the
purrr package. This function gives a one-line replacement for simple for-loops;
it is analogous to list comprehensions in python. It can be useful many places
besides the topic of this tutorial. For example, if we want to convert the
vector <code>c(1, 2, 3)</code> into <code>c(1, 4, 9)</code>, we can use this map:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="integrative-simulation.html#cb78-1" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 9</code></pre>
<p>The <code>~</code> notation is shorthand for defining a function, and the <code>.</code> represents
the current vector element. More generally, we can apply map to lists. This
line will update the list so that 1 is added to each element.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="integrative-simulation.html#cb80-1" tabindex="-1"></a><span class="fu">map</span>(<span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>), <span class="sc">~</span> . <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## $a
## [1] 2
## 
## $b
## [1] 3
## 
## $c
## [1] 4</code></pre>
<p><strong>Exercise</strong>: To test your understanding, can you write a map that computes the
*mean for each
vector in the list <code>x</code> below? What about the mean of the 10 smallest elements?</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="integrative-simulation.html#cb82-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">b =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="integrative-simulation.html#cb83-1" tabindex="-1"></a><span class="fu">map</span>(x, mean)</span></code></pre></div>
<pre><code>## $a
## [1] -0.04524557
## 
## $b
## [1] 1.0684</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="integrative-simulation.html#cb85-1" tabindex="-1"></a><span class="fu">map</span>(x, <span class="sc">~</span> <span class="fu">mean</span>(<span class="fu">sort</span>(.)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]))</span></code></pre></div>
<pre><code>## $a
## [1] -1.915257
## 
## $b
## [1] -0.4088233</code></pre>
</div>
<div id="vertical-integration" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Vertical Integration<a href="integrative-simulation.html#vertical-integration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In horizontal integration, we have many datasets, all with the same features.
They only differ because they were gathered at different times. In contrast, for
vertical integration, we instead have many datasets all with the same <em>samples</em>.
They differ because they measure different aspects of those samples. Our goal in
this situation is not to remove differences across datasets, like it was in
horizontal integration, but instead to clarify the relationships across sources.</p>
<p>One important question that often arises in vertical integration is – are the
data even alignable? That is, in our effort to look for relationships across
datasets, we might accidentally miss out on interesting variation that exists
within the individual assays. If the technologies are measuring very different
things, we might be better off simply analyzing the data separately. To help us
gauge which setting we might be in, we can simulate data where we know that we
shouldn’t align the sources. If our integration methods are giving similar
outputs as they give on this simulated data, then we should be more cautious.</p>
<p>There are a few ways in which a dataset might not be ``alignable.’’ The most
general reason is that there may be no latent sources of variation in common
between the sources. A simpler reason is that something that influenced one
assay substantially (e.g., disease state) might not influence the other by much.
Let’s see how an integration method might work in this setting.</p>
<p>We’ll work with the ICU sepsis dataset previously studied by <a href="https://doi.org/10.1128/mSystems.01148-20">Haak et al.
(2021)</a> and documented within a
<a href="https://raw.githack.com/bioFAM/MOFA2_tutorials/master/R_tutorials/microbiome_vignette.html#train-mofa-model">vignette</a>
for the MOFA package. The three datasets here are 16S bacterial, ITS fungal, and
Virome assays, all applied to different healthy and sepsis patient populations.
Moreover, some participants were on a course of antibiotics while others were
not. The question is how either sepsis, antibiotics, or their interaction
affects the microbiome viewed through these three assays. The data are printed
below, they have already been filtered and CLR transformed following the MOFA
vignette.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="integrative-simulation.html#cb87-1" tabindex="-1"></a><span class="fu">data</span>(icu)</span>
<span id="cb87-2"><a href="integrative-simulation.html#cb87-2" tabindex="-1"></a>icu</span></code></pre></div>
<pre><code>## $Bacteria
## class: SummarizedExperiment 
## dim: 180 57 
## metadata(0):
## assays(1): clr
## rownames(180): Acidaminococcus Actinomyces ... Veillonellaceae Weissella
## rowData names(0):
## colnames(57): TKI_F1 TKI_F10 ... TKI_F8 TKI_F9
## colData names(16): Age Sexs ... Propionate Butyrate
## 
## $Fungi
## class: SummarizedExperiment 
## dim: 18 57 
## metadata(0):
## assays(1): clr
## rownames(18): Agaricus Aspergillus ... Sclerotiniaceae Vishniacozyma
## rowData names(0):
## colnames(57): TKI_F1 TKI_F10 ... TKI_F8 TKI_F9
## colData names(16): Age Sexs ... Propionate Butyrate
## 
## $Viruses
## class: SummarizedExperiment 
## dim: 42 57 
## metadata(0):
## assays(1): clr
## rownames(42): Acidovorax phage Acinetobacter phage ... Streptomyces phage Vibrio phage
## rowData names(0):
## colnames(57): TKI_F1 TKI_F10 ... TKI_F8 TKI_F9
## colData names(16): Age Sexs ... Propionate Butyrate</code></pre>
<p>We can simultaneously analyze these data sources using block sPLS-DA. This is
the multi-assay version of the analysis that we saw in the previous session.
<code>exper_splsda</code> is a very light wrapper of a mixOmics function call, which you
can read
<a href="https://github.com/krisrs1128/intro-to-simulation/blob/9f842ef52fdbe9a137833531147ceb3bc1f7ae81/MIGsim/R/vertical_integration.R#L3">here</a>.
The output plot below shows that each assay differs across groups, and this is
quantitatively summarized by the high estimated weights between each category
and the estimated PLS directions.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="integrative-simulation.html#cb89-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">exper_splsda</span>(icu)</span>
<span id="cb89-2"><a href="integrative-simulation.html#cb89-2" tabindex="-1"></a><span class="fu">plotIndiv</span>(fit)</span></code></pre></div>
<p><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="integrative-simulation.html#cb90-1" tabindex="-1"></a>fit<span class="sc">$</span>weights</span></code></pre></div>
<pre><code>##              comp1     comp2
## Bacteria 0.8580402 0.8191458
## Fungi    0.6513668 0.4845247
## Viruses  0.6118091 0.8047067</code></pre>
<p>How would the output have looked if 16S community composition had not been
related to disease or antibiotics groups? Since integrative analysis prioritizes
similarities across sources, we expect this to mask some of the real differences
in the fungal and virus data as well. We can use simulation to gauge the extent
of this masking.</p>
<p>Our first step is to train a simulator. We’re just learning four different
setes of parameters for each of the four observed groups. This is not as nuanced
as learning separate effects for sepsis and antibiotics, but it will be enough
for illustration. We have used <code>map</code> to estimate a simulator for each assay in
the <code>icu</code> list.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="integrative-simulation.html#cb92-1" tabindex="-1"></a>simulator <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb92-2"><a href="integrative-simulation.html#cb92-2" tabindex="-1"></a>  icu,</span>
<span id="cb92-3"><a href="integrative-simulation.html#cb92-3" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">setup_simulator</span>(., <span class="sc">~</span>Category, <span class="sc">~</span> <span class="fu">GaussianLSS</span>()) <span class="sc">|&gt;</span></span>
<span id="cb92-4"><a href="integrative-simulation.html#cb92-4" tabindex="-1"></a>    <span class="fu">estimate</span>(<span class="at">nu =</span> <span class="fl">0.05</span>)</span>
<span id="cb92-5"><a href="integrative-simulation.html#cb92-5" tabindex="-1"></a>)</span></code></pre></div>
<p>So far, we haven’t tried removing any relationships present in the 16S assay,
and indeed our integrative analysis output on the simulated data looks
comparable to that from the original study.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="integrative-simulation.html#cb93-1" tabindex="-1"></a>icu_sim <span class="ot">&lt;-</span> <span class="fu">join_copula</span>(simulator, <span class="fu">copula_adaptive</span>()) <span class="sc">|&gt;</span></span>
<span id="cb93-2"><a href="integrative-simulation.html#cb93-2" tabindex="-1"></a>  <span class="fu">sample</span>() <span class="sc">|&gt;</span></span>
<span id="cb93-3"><a href="integrative-simulation.html#cb93-3" tabindex="-1"></a>  <span class="fu">split_assays</span>()</span>
<span id="cb93-4"><a href="integrative-simulation.html#cb93-4" tabindex="-1"></a></span>
<span id="cb93-5"><a href="integrative-simulation.html#cb93-5" tabindex="-1"></a>fit_sim <span class="ot">&lt;-</span> <span class="fu">exper_splsda</span>(icu_sim)</span>
<span id="cb93-6"><a href="integrative-simulation.html#cb93-6" tabindex="-1"></a><span class="fu">plotIndiv</span>(fit_sim)</span></code></pre></div>
<p><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="integrative-simulation.html#cb94-1" tabindex="-1"></a>fit<span class="sc">$</span>weights</span></code></pre></div>
<pre><code>##              comp1     comp2
## Bacteria 0.8580402 0.8191458
## Fungi    0.6513668 0.4845247
## Viruses  0.6118091 0.8047067</code></pre>
<p><strong>Exercise</strong>: Modify the simulator above so that the 16S group no longer depends
on disease cateogry. This will allow us to study how the integrative analysis
output changes when the data are not alignable.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="integrative-simulation.html#cb96-1" tabindex="-1"></a>null_simulator <span class="ot">&lt;-</span> simulator</span>
<span id="cb96-2"><a href="integrative-simulation.html#cb96-2" tabindex="-1"></a><span class="co"># fill this in</span></span>
<span id="cb96-3"><a href="integrative-simulation.html#cb96-3" tabindex="-1"></a><span class="co"># null_simulator[[1]] &lt;- ???</span></span></code></pre></div>
<p><strong>Solution</strong>: We need to define a new link that no longer depends on <code>Category</code>. One solution
is to modify the existing simulator in place using <code>mutate</code>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="integrative-simulation.html#cb97-1" tabindex="-1"></a>null_simulator[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> simulator[[<span class="dv">1</span>]] <span class="sc">|&gt;</span></span>
<span id="cb97-2"><a href="integrative-simulation.html#cb97-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">180</span>, <span class="at">link =</span> <span class="sc">~</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb97-3"><a href="integrative-simulation.html#cb97-3" tabindex="-1"></a>  <span class="fu">estimate</span>(<span class="at">nu =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p>Since we are modifying all taxa, a simpler solution is to just define a
new simulator from scratch.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="integrative-simulation.html#cb98-1" tabindex="-1"></a>null_simulator[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">setup_simulator</span>(icu[[<span class="dv">1</span>]], <span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span> <span class="fu">GaussianLSS</span>()) <span class="sc">|&gt;</span></span>
<span id="cb98-2"><a href="integrative-simulation.html#cb98-2" tabindex="-1"></a>  <span class="fu">estimate</span>(<span class="at">nu =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p>We can rerun the integrative analysis using the modified simulator. Somewhat
surprisingly, the disease association in the bacteria group hasn’t been erased.
This is an artifact of the integration. The other assays have associations with
disease group, and since the method encourages outputs across tables to be
consistent with one another, we have artificially introduced some structure into
the bacteria visualization (even if it is quite weak.) Nonetheless, we still
observe a large dropoff in weight for the bacterial table. Further, there seems
to be a minor deterioration in the group separations for the fungal and virus
communities, and the component weights are higher when we work with only the
fungal and virus assays. Altogether, this suggests that we may want to check
table-level associations with the response variable, especially if any of the
integration outputs are ambiguous. In this case, we might be able to increase
power by focusing only on class-associated assays. Nonetheless, the block
sPLS-DA also seems relatively robust – considering the dramatic change in the
microbiome table, the output for the remaining tables still surfaces interesting
relationships.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="integrative-simulation.html#cb99-1" tabindex="-1"></a>icu_sim <span class="ot">&lt;-</span> <span class="fu">join_copula</span>(null_simulator, <span class="fu">copula_adaptive</span>()) <span class="sc">|&gt;</span></span>
<span id="cb99-2"><a href="integrative-simulation.html#cb99-2" tabindex="-1"></a>  <span class="fu">sample</span>() <span class="sc">|&gt;</span></span>
<span id="cb99-3"><a href="integrative-simulation.html#cb99-3" tabindex="-1"></a>  <span class="fu">split_assays</span>()</span>
<span id="cb99-4"><a href="integrative-simulation.html#cb99-4" tabindex="-1"></a>fit_null <span class="ot">&lt;-</span> <span class="fu">exper_splsda</span>(icu_sim)</span>
<span id="cb99-5"><a href="integrative-simulation.html#cb99-5" tabindex="-1"></a><span class="fu">plotIndiv</span>(fit)</span></code></pre></div>
<p><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="integrative-simulation.html#cb100-1" tabindex="-1"></a>fit_null<span class="sc">$</span>weights</span></code></pre></div>
<pre><code>##              comp1     comp2
## Bacteria 0.5886651 0.6873822
## Fungi    0.7647532 0.6900530
## Viruses  0.6284801 0.7759833</code></pre>
<p><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-44-1.png" width="672" /><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-44-2.png" width="672" /><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-44-3.png" width="672" /><img src="simulation_for_microbiome_files/figure-html/unnamed-chunk-44-4.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="integrative-simulation.html#cb102-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.4.0 (2024-04-24)
## Platform: aarch64-apple-darwin20
## Running under: macOS Ventura 13.4
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: Australia/Melbourne
## tzcode source: internal
## 
## attached base packages:
##  [1] splines   parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] TreeSummarizedExperiment_2.12.0 Biostrings_2.72.1               XVector_0.44.0                  SingleCellExperiment_1.26.0    
##  [5] scDesigner_0.0.0.9000           MIGsim_0.0.0.9000               tidyr_1.3.1                     tibble_3.2.1                   
##  [9] scico_1.5.0                     purrr_1.0.2                     patchwork_1.2.0                 mixOmics_6.28.0                
## [13] lattice_0.22-6                  MASS_7.3-60.2                   glue_1.7.0                      ggplot2_3.5.1                  
## [17] ggdist_3.3.2                    gamboostLSS_2.0-7               mboost_2.9-10                   stabs_0.6-4                    
## [21] forcats_1.0.0                   dplyr_1.1.4                     SummarizedExperiment_1.34.0     Biobase_2.64.0                 
## [25] GenomicRanges_1.56.0            GenomeInfoDb_1.40.0             IRanges_2.38.0                  S4Vectors_0.42.0               
## [29] BiocGenerics_0.50.0             MatrixGenerics_1.16.0           matrixStats_1.3.0               SpiecEasi_1.1.3                
## [33] CovTools_0.5.4                 
## 
## loaded via a namespace (and not attached):
##   [1] minpack.lm_1.2-4            XML_3.99-0.16.1             rpart_4.1.23                lifecycle_1.0.4             Rdpack_2.6                 
##   [6] edgeR_4.2.0                 doParallel_1.0.17           MultiAssayExperiment_1.30.2 insight_0.20.1              magrittr_2.0.3             
##  [11] limma_3.60.2                sass_0.4.9                  rmarkdown_2.27              jquerylib_0.1.4             yaml_2.3.8                 
##  [16] DBI_1.2.3                   RColorBrewer_1.1-3          ADGofTest_0.3               abind_1.4-5                 zlibbioc_1.50.0            
##  [21] expm_0.999-9                quadprog_1.5-8              pspline_1.0-20              kde1d_1.0.7                 rgl_1.3.1                  
##  [26] yulab.utils_0.1.4           pracma_2.4.4                sva_3.50.0                  GenomeInfoDbData_1.2.12     ggrepel_0.9.5              
##  [31] tidytree_0.4.6              genefilter_1.86.0           ellipse_0.5.0               RSpectra_0.16-1             annotate_1.82.0            
##  [36] codetools_0.2-20            DelayedArray_0.30.1         shapes_1.2.7                tidyselect_1.2.1            shape_1.4.6.1              
##  [41] UCSC.utils_1.0.0            farver_2.1.2                randtoolbox_2.0.4           base64enc_0.1-3             jsonlite_1.8.8             
##  [46] Formula_1.2-5               survival_3.7-0              iterators_1.0.14            systemfonts_1.1.0           foreach_1.5.2              
##  [51] tools_4.4.0                 progress_1.2.3              treeio_1.28.0               ragg_1.3.2                  Rcpp_1.0.12                
##  [56] rARPACK_0.11-0              BiocBaseUtils_1.6.0         gridExtra_2.3               SparseArray_1.4.8           mgcv_1.9-1                 
##  [61] xfun_0.44                   distributional_0.4.0        withr_3.0.0                 numDeriv_2016.8-1.1         fastmap_1.2.0              
##  [66] fansi_1.0.6                 digest_0.6.35               R6_2.5.1                    textshaping_0.4.0           colorspace_2.1-0           
##  [71] RSQLite_2.3.7               inum_1.0-5                  copula_1.1-3                flare_1.7.0.1               utf8_1.2.4                 
##  [76] generics_0.1.3              corpcor_1.6.10              prettyunits_1.2.0           pulsar_0.3.11               httr_1.4.7                 
##  [81] htmlwidgets_1.6.4           S4Arrays_1.4.1              scatterplot3d_0.3-44        rngWELL_0.10-9              pkgconfig_2.0.3            
##  [86] geigen_2.3                  gtable_0.3.5                blob_1.2.4                  pcaPP_2.0-4                 htmltools_0.5.8.1          
##  [91] bookdown_0.39.1             ruv_0.9.7.1                 scales_1.3.0                SHT_0.1.8                   png_0.1-8                  
##  [96] knitr_1.47                  rstudioapi_0.16.0           reshape2_1.4.4              nlme_3.1-164                cachem_1.1.0               
## [101] stringr_1.5.1               libcoin_1.0-10              AnnotationDbi_1.66.0        pillar_1.9.0                grid_4.4.0                 
## [106] vctrs_0.6.5                 VGAM_1.1-11                 huge_1.3.5                  xtable_1.8-4                gamlss.dist_6.1-1          
## [111] evaluate_0.23               mvtnorm_1.2-5               cli_3.6.2                   locfit_1.5-9.9              compiler_4.4.0             
## [116] rlang_1.1.4                 crayon_1.5.2                labeling_0.4.3              plyr_1.8.9                  fs_1.6.4                   
## [121] stringi_1.8.4               BiocParallel_1.38.0         nnls_1.5                    assertthat_0.2.1            rvinecopulib_0.6.3.1.1     
## [126] munsell_0.5.1               gsl_2.1-8                   lazyeval_0.2.2              glmnet_4.1-8                Matrix_1.7-0               
## [131] hms_1.1.3                   stabledist_0.7-1            bit64_4.0.5                 KEGGREST_1.44.0             statmod_1.5.0              
## [136] highr_0.11                  rbibutils_2.2.16            partykit_1.2-20             igraph_2.0.3                memoise_2.0.1              
## [141] bslib_0.7.0.9000            bit_4.0.5                   ape_5.8</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="microbiome-networks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-integration.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["simulation_for_microbiome.pdf", "simulation_for_microbiome.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
